ARG PYTHON_VERSION
ARG VERSION
ARG OUTPUT_DIR


FROM base as 9.2.0
ENV FFMPEG_BUILD_VER=4.4.1-7


FROM ${VERSION}
RUN git clone https://github.com/PyAV-Org/pyav-ffmpeg.git && \
    cd pyav-ffmpeg && \
    git checkout 4.4.1-7
ENV CIBUILDWHEEL=1

COPY *.patch .
WORKDIR pyav-ffmpeg
RUN git apply ../${VERSION}.patch
RUN python3.8 scripts/build-ffmpeg.py /tmp/vendor 1
WORKDIR ..
